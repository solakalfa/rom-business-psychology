---
import Layout from "../layouts/Layout.astro";
import TeamCard from "../components/TeamCard.astro";
import Footer from "../components/Footer.astro";
---

<Layout title="Our Team - ROM Business Psychology">
  <!-- BREADCRUMB -->
  <section class="bg-gray-50 py-4">
    <div class="container mx-auto px-6 max-w-4xl">
      <nav class="flex items-center text-sm text-gray-600">
        <a href="/" class="hover:text-cyan-600">Home</a>
        <svg
          class="w-4 h-4 mx-2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"></path>
        </svg>
        <span class="text-gray-900">Our Team</span>
      </nav>
    </div>
  </section>

  <!-- HERO -->
  <section class="bg-white py-16">
    <div class="container mx-auto px-6 max-w-4xl">
      <p
        class="text-cyan-600 font-semibold text-sm uppercase tracking-wider mb-4"
      >
        Our Team
      </p>
      <h1 class="text-gray-900 mb-6">Meet the family</h1>
      <p class="text-xl text-gray-600 leading-relaxed">
        We are a group of practitioners from the fields of psychology and
        organizational development. We all hold significant managerial
        experience and advanced academic degrees. We are professionals so we
        make sure that we continue to learn and develop ourselves, receive
        supervision from field experts, and participate in continuous training.
      </p>
    </div>
  </section>

  <!-- Team Grid -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-6 max-w-4xl">
      <div
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 auto-rows-fr"
      >
        <div class="h-full">
          <TeamCard
            name="Eldad Rom (Ph.D.)"
            role="Founder & CEO"
            image="/team/dreldadrom.jpeg"
            memberId="eldad"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="David Segal (Ph.D.)"
            role="Clinical Psychologist"
            image="/team/dr-david-segal.jpg"
            memberId="david"
            customClass="object-top scale-95"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="Ganit Rainer Sassover (M.A.)"
            role="Executive Coach"
            image="/team/Ganit.jpg"
            memberId="ganit"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="Netta Gefen (M.A.)"
            role="Organizational Consultant"
            image="/team/Netta-Gefen-Organizational-consultant.jpg"
            memberId="netta"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="Meital Drezner-Maimon (M.A.)"
            role="Organizational Consultant"
            image="/team/meital.jpg"
            memberId="meital"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="Anat Frishman (M.A.)"
            role="Organizational Consultant"
            image="/team/anat-1.jpg"
            memberId="anat"
          />
        </div>

        <div class="h-full">
          <TeamCard
            name="Edna Arbel (M.A.)"
            role="Executive Coach"
            image="/team/עדנה-ארבל.jpg"
            memberId="edna"
            customClass="object-top scale-95"
          />
        </div>

        <!-- Quote Box -->
        <div
          class="relative bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 p-8 rounded-2xl flex items-center justify-center text-center hover:border-cyan-400 transition-colors h-full"
        >
          <div class="absolute -top-3 -left-3 w-6 h-6 bg-cyan-600 rounded-full">
          </div>
          <blockquote class="text-base font-light text-gray-700">
            "When I build a team, I first look for people who love to win."
            <span class="text-sm mt-3 block text-cyan-600 font-semibold"
              >— Ross Perot</span
            >
          </blockquote>
        </div>
      </div>
    </div>
  </section>

  <!-- Popup Container -->
  <div id="popup-container"></div>

  <Footer />
</Layout>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll("[data-member-id]");
    const container = document.getElementById("popup-container");

    if (!container) return;

    buttons.forEach((button) => {
      button.addEventListener("click", async () => {
        const memberId = button.getAttribute("data-member-id");

        try {
          const { getTeamMembers } = await import("../data/team.js");
          const teamData = await getTeamMembers();
          const member = teamData[memberId];

          if (!member) return;

          container.innerHTML = `
            <div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4" id="popup-backdrop">
              <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden shadow-2xl">
                
                <div class="sticky top-0 bg-gradient-to-r from-cyan-600 to-blue-600 text-white p-6 flex items-center justify-between">
                  <div class="flex items-center gap-4">
                    <img src="${member.image}" alt="${member.name}" class="w-16 h-16 rounded-full object-cover border-2 border-white" />
                    <div>
                      <h2 class="text-xl font-bold">${member.name}</h2>
                      <p class="text-cyan-100">${member.role}</p>
                    </div>
                  </div>
                  <button id="close-popup" class="text-white hover:rotate-90 transition-transform duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
                
                <div class="p-6 overflow-y-auto max-h-[calc(90vh-120px)]">
                  <p class="text-gray-700 leading-relaxed whitespace-pre-line">${member.bio}</p>
                  
                  ${
                    member.email
                      ? `
                    <div class="mt-6 pt-6 border-t border-gray-200">
                      <a href="mailto:${member.email}" class="inline-flex items-center gap-2 text-cyan-600 hover:text-cyan-700 font-medium">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                        </svg>
                        ${member.email}
                      </a>
                    </div>
                  `
                      : ""
                  }
                </div>
              </div>
            </div>
          `;

          const closeBtn = document.getElementById("close-popup");
          const backdrop = document.getElementById("popup-backdrop");

          const closePopup = () => {
            container.innerHTML = "";
          };

          closeBtn?.addEventListener("click", closePopup);
          backdrop?.addEventListener("click", (e) => {
            if (e.target === backdrop) closePopup();
          });

          document.addEventListener("keydown", function escHandler(e) {
            if (e.key === "Escape") {
              closePopup();
              document.removeEventListener("keydown", escHandler);
            }
          });
        } catch (error) {
          console.error("Error loading team member:", error);
        }
      });
    });
  });
</script>
